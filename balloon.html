<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Heart Balloons</title>
  <style>
    :root{
      --bg:#ffffff;
      --pink1:#e02424; --pink2:#ff2d55; --pink3:#ff3b3b; --pink4:#ff6b6b; --pink5:#ff8a8a;
      --accent:#e11d48;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:#111; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      overflow:hidden; display:grid; grid-template-rows:auto 1fr auto; place-items:center;
    }
    header{
      margin-top:14px; text-align:center; padding:6px 12px; border-radius:12px; color:#a40028;
      text-shadow:0 2px 6px rgba(224,29,72,.25);
      font-weight:800; font-size:clamp(22px,4.6vw,40px);
    }
    .wrap{ position:relative; width:min(100vw, 980px); height:min(70vh, 600px); }
    canvas{ width:100%; height:100%; display:block; filter: drop-shadow(0 0 10px rgba(224,29,72,.2)); }

    /* Timer bar */
    .timer{
      margin:8px 0 0; font-weight:800; font-size:clamp(14px,2.6vw,22px);
      color:#7a1024; letter-spacing:.3px; text-shadow:0 0 6px rgba(224,29,72,.20);
    }
    .timer .num{ color:#7a1024; padding:2px 8px; border-radius:9px; background:#ffd9e5; margin:0 4px; display:inline-block; min-width:54px; text-align:center; }

    /* Back button */
    .back {
      position: fixed;
      left: calc(16px + env(safe-area-inset-left));
      bottom: calc(16px + env(safe-area-inset-bottom));
      background: #ff84b0;
      color: #fff;
      padding: 14px 20px; /* >=44px touch height */
      border-radius: 999px;
      text-decoration: none;
      font-weight: 900;
      box-shadow: 0 10px 24px rgba(255,132,176,.35);
      border: 0;
    }
    .back:hover{ filter:brightness(1.07) }

    .note { text-shadow: 0 0 8px rgba(224,29,72,0.15); }
  </style>
</head>
<body>
  <header>💕 Balloons of Love 💕</header>

  <div class="wrap">
    <canvas id="c"></canvas>
  </div>

  <div class="note" style="margin-top:16px;text-align:center;color:#a40028;font-weight:700;font-size:clamp(16px,3vw,26px);">
    3 years down, forever to go 😘
  </div>

  <a class="back" href="yes.html">← Back to gifts</a>

<script>
// =======================
// CONFIG
// =======================
// 👉 Set your relationship start date/time here (local time OK)
// Example: 2022-11-01 00:00 in Sri Lanka (UTC+05:30)
const START_DATE = new Date('2022-11-01T00:00:00+05:30');

// Canvas heart made of tiny hearts
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W, H, DPR;
function resize(){
  DPR = Math.min(1.5, window.devicePixelRatio || 1); // cap DPR for mobile perf
  W = canvas.clientWidth; H = canvas.clientHeight;
  canvas.width = Math.max(1, Math.floor(W * DPR));
  canvas.height = Math.max(1, Math.floor(H * DPR));
  ctx.setTransform(DPR,0,0,DPR,0,0);
  buildTargets(); // rebuild points to fit new size
  hearts.length = 0; // reset animation so it refills neatly
  spawnIndex = 0;
}
window.addEventListener('resize', resize, {passive:true}); resize();

// Create target points for a big heart using parametric equation
// Heart equation scaled & centered
function heartPoint(t, scale){
  const x = 16 * Math.sin(t)**3;
  const y = 13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
  return {x: x*scale, y: -y*scale}; // invert y to point up
}

// Sample many points and jitter them to form a filled heart grid
const targetPoints = [];
function buildTargets(){
  targetPoints.length = 0;
  const shortSide = Math.min(W, H);
  const scale = shortSide * 0.038;     // heart size scales with viewport
  const cx = W/2, cy = H/2;            // center

  // Density scales with size (smaller screens -> fewer points)
  const densityFactor = shortSide < 480 ? 0.6 : shortSide < 760 ? 0.8 : 1.0;
  const outlineCount = Math.floor(420 * densityFactor);
  const interiorCount = Math.floor(1400 * densityFactor);

  // Outline (single crisp heart)
  for(let i=0;i<outlineCount;i++){
    const t = i/outlineCount * Math.PI*2;
    const p = heartPoint(t, scale);
    targetPoints.push({x: cx + p.x + (Math.random()-0.5)*2.0, y: cy + p.y + (Math.random()-0.5)*2.0});
  }

  // Dense interior fill using radial samples (r biased toward 1)
  for(let i=0;i<interiorCount;i++){
    const r = Math.sqrt(Math.random());
    const t = Math.random()*Math.PI*2;
    const p = heartPoint(t, scale * r);
    targetPoints.push({x: cx + p.x + (Math.random()-0.5)*4.5, y: cy + p.y + (Math.random()-0.5)*4.5});
  }
}

// Tiny hearts that pop and fly to their spots
const colors = ['#e02424','#ff2d55','#ff3b3b','#ff6b6b','#ff8a8a'];
const hearts = [];
function spawnHeart(){
  if (spawnIndex >= targetPoints.length) return;
  const target = targetPoints[spawnIndex++];
  const angle = Math.random()*Math.PI*2;
  const radius = Math.max(W,H)*0.6;
  const start = {x: W/2 + Math.cos(angle)*radius, y: H + Math.sin(angle)*radius*0.4};
  hearts.push({
    x:start.x, y:start.y, tx:target.x, ty:target.y,
    size: 10 + Math.random()*12,
    color: colors[(Math.random()*colors.length)|0],
    t: 0, dur: 50 + Math.random()*35, // frames to reach target
    pop: 0
  });
}

let spawnIndex = 0;
let spawnTimer = 0;
function update(){
  ctx.clearRect(0,0,W,H);

  // spawn rapidly until all targets are filled
  if (spawnIndex < targetPoints.length){
    const batch = (Math.min(W,H) < 480) ? 48 : 36;
    for(let i=0;i<batch;i++) spawnHeart();
  }

  // draw hearts
  for (let i=0;i<hearts.length;i++){
    const h = hearts[i];
    if (h.t < h.dur){ h.t++; }
    const k = h.t / h.dur; // 0..1
    // ease
    const e = 1 - Math.pow(1-k, 3);
    h.x = h.x + (h.tx - h.x) * e * 0.14;
    h.y = h.y + (h.ty - h.y) * e * 0.14;

    drawHeart(h.x, h.y, h.size*(0.9 + Math.sin((i+h.t)*0.08)*0.05), h.color, 0.15);
  }
  requestAnimationFrame(update);
}
requestAnimationFrame(update);

function drawHeart(x, y, s, color, glow){
  ctx.save();
  ctx.translate(x, y);
  ctx.rotate(-Math.PI/4);
  ctx.fillStyle = color;
  if (glow){ ctx.shadowColor = color; ctx.shadowBlur = 10; }
  // square
  ctx.fillRect(-s/2, -s/2, s, s);
  // circles
  ctx.beginPath();
  ctx.arc(0, -s/2, s/2, 0, Math.PI*2);
  ctx.arc(-s/2, 0, s/2, 0, Math.PI*2);
  ctx.fill();
  ctx.restore();
}

// Add more hearts on tap/click
canvas.addEventListener('click', ()=>{
  for(let i=0;i<40;i++) spawnHeart();
});

// Rebuild targets when resized
window.addEventListener('resize', ()=>{ buildTargets(); });

/*
Notes:
- Hosting on GitHub Pages is perfect: the timer uses the viewer's device time.
- If you want a precise timezone, simply set START_DATE with an offset like "+05:30".
- To change the heart size/amount, tweak buildTargets() sample counts and scale multiplier.
*/
</script>
</body>
</html>